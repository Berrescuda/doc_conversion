=====================
Demo UI Configuration
=====================

A lightweight OpenDCRE demo is included with the OpenMistOS image and can be run as a docker container (along with the OpenDCRE container). By default, the demo is accessible on port 80 of the Pi running OpenMistOS. If desired, the demo container can be set to run on startup along with the OpenDCRE container.

Getting the Demo
----------------

The demo site can be downloaded as a standalone image from `DockerHub`__, or the demo source can be download from `GitHub`__.

.. _DockerHub: https://hub.docker.com/r/vaporio/opendcre-demo

__ DockerHub_

.. _GitHub: https://github.com/vapor-ware/opendcre-demo

__ GitHub_

From DockerHub:
::
    docker pull vaporio/opendcre-demo

From GitHub:
::
    git clone https://github.com/vapor-ware/opendcre-demo

Configuring the Demo
--------------------

By default, the demo expects the base OpenDCRE endpoint to be at:

http://opendcre:5000

In order to interact with the demo and successfully query against the OpenDCRE endpoint, you will need to add 'opendcre' as a host in your ``/etc/hosts`` file. For example, if the Raspberry Pi running the OpenDCRE endpoint has IP address 192.168.1.100, you would add the following entry to ``/etc/hosts``:

``
192.168.1.100      opendcre
``


The OpenDCRE endpoint url can be changed in the demo config file, if desired. The demo config file can be found in the demo source at:  
demo/assets/js/opendcre/opendcre.config.js

Other configurable options provided in the opendcre.config.js file are summarized in the table below.

{| class="wikitable"
! style="text-align:center;" | Option		
!Default Value
!Description
|-
|``opendcre_base_url``
|http://opendcre:5000/opendcre/1.1/
|base url for endpoint queries
|-
|``opendcre_thermistor_limit``
|41
|y-value at which red line is added to thermistor graphs to represent ‘max allowable value’ limit
|-
|``chart_points``
|25
|maximum number of points to include in sensor graphs
|-
|``thermistor_poll_interval``
|750
|time (in milliseconds) of the polling interval for thermistor reads
|}

Running the Demo
----------------

If you’ve downloaded a standalone version of the demo from DockerHub, you can run a container instance of the image with:
::
    docker run -d -p 80:80 -v /var/log/opendcre:/logs vaporio/opendcre-demo

If you’ve downloaded a standalone version of the demo from GitHub, you need to build the image before a container can be run.
::
    docker build -f Dockerfile.rpi -t vaporio/opendcre-demo .

then, a container instance can be run
::
    docker run -d -p 80:80 -v /var/log/opendcre:/logs vaporio/opendcre-demo

If running successfully, when you navigate to the correct demo url (the url of the Raspberry Pi running it, on port 80), the demo page should show up.

To connect to the OpenDCRE endpoint: from the ‘Select a Rack’ drop-down menu at the top of the demo page, select ‘Rack #1’. If hooked up to the endpoint correctly, the sensors/boards/servers navigation list items should be populated. If the demo is not configured correctly or your ``/etc/hosts`` is not set up correctly, an alert should show up letting you know that you were unable to connect.
